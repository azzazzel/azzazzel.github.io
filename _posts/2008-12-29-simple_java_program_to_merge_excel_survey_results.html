---
layout: post
title: Simple Java program to merge Excel survey results
date: '2008-12-29 14:13:20 +0100'
mt_id: 4
blog_id: 1
post_id: 4
basename: simple_java_program_to_merge_excel_survey_results
categories:
- software
---

<p style="text-align: justify;">A friend of mine recently asked me about merging survey results, which reminded me I had similar problem about an year ago and have written a peace of code to solve it. It's not a framework or user friendly application and it's not well documented. It was written in a couple of hours to solve particular problem, but in case anyone is interested here is&nbsp; so called <a href="/assets/2008-12-29-simple_java_program_to_merge_excel_survey_results/SpreadSurvey.zip">SpreadSurvey</a>.</p>

<!--more-->

<p style="text-align: justify;">&nbsp;</p><form contenteditable="false" mt:asset-id="2" class="mt-enclosure mt-enclosure-image" style="display: inline;"><img width="287" height="165" alt="survey.png" src="/assets/2008-12-29-simple_java_program_to_merge_excel_survey_results/survey.png" class="mt-image-left" style="margin: 0pt 20px 20px 0pt; float: left;" /></form><p>The problem I was facing back then, was how to ask about 20 questions to about 50 people and get their answers into single excel file. There is plenty of tools and services out there for managing polls and surveys, but I was not allowed to place company related data outside company's network.&nbsp; &nbsp; <br />So I prepared a survey as simple form in a excel file (unfortunately can not show the actual one here, but it was much like this sample one) and sent it to everyone in my target group, kindly asking them to fill it in and send it back. So I got back about 50 files containing filled forms. The question was how to merge them into single file? <br />Since I'm a Java geek and I had been using Apache POI already and those files had all the same structure, the answer was obvious. A simple Java program could iterate over those files extract any useful data and merge it into a single file. This is how an eclipse quickie called&nbsp; SpreadSurvey was born. </p><form contenteditable="false" mt:asset-id="3" class="mt-enclosure mt-enclosure-image" style="display: inline;"><img width="229" height="111" alt="survey-template-1.png" src="/assets/2008-12-29-simple_java_program_to_merge_excel_survey_results/survey-template-1.png" class="mt-image-left" style="margin: 0pt 20px 20px 0pt; float: left;" /></form><p>Besides the files containing the answers it needs a template for the output file.Template is nothing more than another excel file containing some special tags. <i><b>{ss}:this</b></i> extract data from the cell having exactly the same row and column as the one in template file. <i><b>{ss}:cell(C:R)</b></i> extracts data from cell at column C and row R.The result file is produced by repeating (horizontally or vertically) the template area containing special tags for each result file. For example if we have a simple template and 3 files containing answers to the sample survey as shown in above images, then this: <br /> <br /> <code class="block"> $ java com.commsen.ss.MergeResults -t template.xls -r result.xls -d X /tmp/results/* </code> <br /> will print  <br /> <br /> <code class="block"> Found expression at 1:2 <br />Found expression at 1:3 <br />Found expression at 1:4 <br />Found expression at 1:5 <br />Template expresions found in area 1:2 - 1:5 <br />processing file: /tmp/results/survey_result1.xls <br />processing file: /tmp/results/survey_result2.xls <br />processing file: /tmp/results/survey_result3.xls </code> <br /><br /> and will generate file<small><code>/tmp/result.xls</code></small> which looks like this: </p><form contenteditable="false" mt:asset-id="4" class="mt-enclosure mt-enclosure-image" style="display: inline;"><img width="382" height="122" alt="survey-result-1.png" src="/assets/2008-12-29-simple_java_program_to_merge_excel_survey_results/survey-result-1.png" class="mt-image-center" style="margin: 0pt auto 20px; text-align: center; display: block;" /></form><p>Alternatively the same data can be organized in columns instead of rows. Just need to provide different template  </p><form contenteditable="false" mt:asset-id="5" class="mt-enclosure mt-enclosure-image" style="display: inline;"><img width="324" height="90" alt="survey-template-2.png" src="/assets/2008-12-29-simple_java_program_to_merge_excel_survey_results/survey-template-2.png" class="mt-image-center" style="margin: 0pt auto 20px; text-align: center; display: block;" /></form><p>and tell SpreadSurvey to repeat vertically  <br /> <br /> <code class="block"> $ java com.commsen.ss.MergeResults -t template2.xls -r result2.xls -d <b>Y</b> /tmp/results/*<br /> Found expression at 1:2<br /> Found expression at 2:2<br /> Found expression at 3:2<br /> Found expression at 4:2<br /> Template expresions found in area 1:2 - 4:2<br /> processing file: /tmp/results/survey_result1.xls<br /> processing file: /tmp/results/survey_result2.xls<br /> processing file: /tmp/results/survey_result3.xls<br /> </code>  <br /> and  file <small><code>/tmp/result2.xls</code></small> will look like this:<br />&nbsp;</p><form contenteditable="false" mt:asset-id="6" class="mt-enclosure mt-enclosure-image" style="display: inline;"><img width="322" height="103" alt="survey-result-2.png" src="/assets/2008-12-29-simple_java_program_to_merge_excel_survey_results/survey-result-2.png" class="mt-image-center" style="margin: 0pt auto 20px; text-align: center; display: block;" /></form><p>So as I said earlier there is no rocket science here. It' s just simple tool I wrote some time ago, that turned out to be useful for someone else. It was never meant to be released or further developed so there is no JavaDoc and the code is not documented either. Only this help screen shows how to use it: <br /> <br /> <code class="block"> $ java com.commsen.ss.MergeResults --help<br />Usage:&nbsp; MergeResults [OPTION...] FILE...<br /><br /> Options:<br />&nbsp; -t, --template-file=&lt;filename&gt;&nbsp;&nbsp; Specify the name of the template file.<br />&nbsp; -r, --result-file=&lt;filename&gt;&nbsp;&nbsp;&nbsp;&nbsp; Specify the name of the result file.<br />&nbsp; -O, --overwrite&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add to overwrite result file if exists.<br />&nbsp; -d, --direction=&lt;X|Y&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify whether data is added in columns or <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rows (default is X)<br />&nbsp; -S, --skip-broken&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add to skip broken files<br /><br />Help options:<br />&nbsp; -?, --help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show this help message<br />&nbsp; --usage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; show brief usage message </code> <br /> <br />Feel free to use it and/or modify it as needed. Don't forget to send me feedback if you do so ;) &nbsp; <br />The package contains source code as well as unmodified versions of used libraries :&nbsp; <a href="http://poi.apache.org/">POI</a>, <a href="http://commons.apache.org/io/">commons-io</a> and <a href="http://te-code.sourceforge.net/">te-common</a>. <b><i><font style="font-size: 0.8em;">(Please check appropriate sites regarding licensing and terms of usage)</font></i></b>.</p><p>&nbsp;</p>
